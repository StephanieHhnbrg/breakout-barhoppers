<div class="dialog">
  <h2 mat-dialog-title>Create Quest</h2>
  <mat-dialog-content>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div>
        <mat-form-field>
          <mat-label>Quest Name</mat-label>
          <input matInput id="name" formControlName="name">
          <mat-error *ngIf="form.get('name')?.touched && form.get('name')?.invalid">
            Name is required.
          </mat-error>
        </mat-form-field>
      </div>

      <div>
        <mat-form-field>
          <mat-label>Quest Name</mat-label>
          <textarea matInput id="description" formControlName="description"></textarea>
          <mat-error *ngIf="form.get('description')?.touched && form.get('description')?.invalid">
            Description is required.
          </mat-error>
        </mat-form-field>
      </div>
    </form>

    <mat-button-toggle-group [(ngModel)]="view" hideSingleSelectionIndicator=true>
      <mat-button-toggle value="single">Single day</mat-button-toggle>
      <mat-button-toggle value="multiple">Multiple days</mat-button-toggle>
      <mat-button-toggle value="regular">Regularly</mat-button-toggle>
    </mat-button-toggle-group>

    <p>&nbsp;</p>

    <div *ngIf="view == 'single'">
      <mat-form-field>
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="singlePicker" [value]="singleDateForm.value">
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="singlePicker"></mat-datepicker-toggle>
        <mat-datepicker #singlePicker></mat-datepicker>
      </mat-form-field>
    </div>

    <div *ngIf="view == 'multiple'">
      <mat-form-field>
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="multiPicker"
               (dateInput)="addDate($event)"
               (dateChange)="addDate($event)">
        <mat-hint>MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="multiPicker"></mat-datepicker-toggle>
        <mat-datepicker #multiPicker></mat-datepicker>
      </mat-form-field>
      <br />
      <mat-chip-row *ngFor="let d of multipleDates;  index as i" (removed)="removeDate(i)">
        {{getDateString(d)}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip-row>
    </div>

    <div *ngIf="view == 'regular'">
      <mat-form-field>
        <mat-label>Weekdays</mat-label>
        <mat-select [formControl]="regularDateForm" multiple>
          <mat-option *ngFor="let option of weekDayOptions" [value]="option.value">{{option.text}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>

    <p>&nbsp;</p>

    <div>
      <mat-form-field>
        <mat-select [formControl]="startTimeForm">
          <mat-option *ngFor="let option of timeOptions" [value]="option.value">{{option.text}}</mat-option>
        </mat-select>
        <mat-label><mat-icon>schedule</mat-icon> Start time</mat-label>
      </mat-form-field>
      <br />
      <mat-form-field>
        <mat-select [formControl]="endTimeForm">
          <mat-option *ngFor="let option of timeOptions" [value]="option.value">{{option.text}}</mat-option>
        </mat-select>
        <mat-label><mat-icon>schedule</mat-icon> End time</mat-label>
      </mat-form-field>
    </div>


  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-button type="submit" [disabled]="!isValidForm()" (click)="onSubmit()">Add</button>
  </mat-dialog-actions>
</div>
